<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transpilador Python ‚Üí JavaScript</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/monokai.min.css">
    <style>
        body {
            background-color: #f8f9fa;
        }
        .code-container {
            height: 400px;
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
        }
        .CodeMirror {
            height: 100%;
            font-family: 'Fira Code', 'Monaco', 'Consolas', monospace;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        .btn-transpile {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            padding: 0.75rem 2rem;
            font-weight: 600;
        }
        .btn-transpile:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
        }
        .example-card {
            transition: transform 0.2s;
            cursor: pointer;
        }
        .example-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .loading-spinner {
            display: none;
        }
        .alert-container {
            margin-top: 1rem;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="container">
            <h1 class="text-center mb-0">üêç ‚û°Ô∏è üìú</h1>
            <h2 class="text-center">Transpilador Python para JavaScript</h2>
            <p class="text-center mb-0">Converta seu c√≥digo Python para JavaScript automaticamente</p>
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">üêç C√≥digo Python</h5>
                        <button class="btn btn-sm btn-outline-secondary" onclick="clearPython()">Limpar</button>
                    </div>
                    <div class="card-body p-0">
                        <div class="code-container">
                            <textarea id="python-code" placeholder="Digite seu c√≥digo Python aqui..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card h-100">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">üìú C√≥digo JavaScript</h5>
                        <button class="btn btn-sm btn-outline-secondary" onclick="copyToClipboard()">Copiar</button>
                    </div>
                    <div class="card-body p-0">
                        <div class="code-container">
                            <textarea id="js-code" readonly placeholder="O c√≥digo JavaScript aparecer√° aqui..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center my-4">
            <button class="btn btn-primary btn-transpile btn-lg" onclick="transpileCode()">
                <span class="transpile-text">üîÑ Transpilar C√≥digo</span>
                <span class="loading-spinner">
                    <span class="spinner-border spinner-border-sm me-2" role="status"></span>
                    Transpilando...
                </span>
            </button>
        </div>

        <div class="alert-container"></div>

        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">üìö Exemplos</h5>
            </div>
            <div class="card-body">
                <div class="row" id="examples-container">
                    <!-- Exemplos ser√£o carregados aqui -->
                </div>
            </div>
        </div>

        <div class="card mt-4">
            <div class="card-header">
                <h5 class="mb-0">‚ÑπÔ∏è Funcionalidades Suportadas</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">‚úÖ Fun√ß√µes e chamadas</li>
                            <li class="list-group-item">‚úÖ Vari√°veis e constantes</li>
                            <li class="list-group-item">‚úÖ Estruturas if/else</li>
                            <li class="list-group-item">‚úÖ Loops for e while</li>
                            <li class="list-group-item">‚úÖ Opera√ß√µes matem√°ticas</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">‚úÖ Listas e dicion√°rios</li>
                            <li class="list-group-item">‚úÖ Classes b√°sicas</li>
                            <li class="list-group-item">‚úÖ F-strings</li>
                            <li class="list-group-item">‚úÖ Operadores de compara√ß√£o</li>
                            <li class="list-group-item">‚úÖ Fun√ß√µes built-in b√°sicas</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="mt-5 py-4 bg-dark text-light">
        <div class="container text-center">
            <p class="mb-0">Transpilador Python ‚Üí JavaScript | Desenvolvido com ‚ù§Ô∏è</p>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/javascript/javascript.min.js"></script>
    
    <script>
        let pythonEditor, jsEditor;

        // Inicializar editores CodeMirror
        document.addEventListener('DOMContentLoaded', function() {
            pythonEditor = CodeMirror.fromTextArea(document.getElementById('python-code'), {
                mode: 'python',
                theme: 'monokai',
                lineNumbers: true,
                indentUnit: 4,
                indentWithTabs: false,
                lineWrapping: true
            });

            jsEditor = CodeMirror.fromTextArea(document.getElementById('js-code'), {
                mode: 'javascript',
                theme: 'monokai',
                lineNumbers: true,
                indentUnit: 2,
                indentWithTabs: false,
                lineWrapping: true,
                readOnly: true
            });

            // Carregar exemplos
            loadExamples();

            // Exemplo inicial
            const initialCode = `def saudacao(nome):
    return f"Ol√°, {nome}!"

idade = 25
if idade >= 18:
    print(saudacao("Jo√£o"))
else:
    print("Menor de idade")

numeros = [1, 2, 3, 4, 5]
for num in numeros:
    print(f"N√∫mero: {num}")`;

            pythonEditor.setValue(initialCode);
        });

        async function transpileCode() {
            const pythonCode = pythonEditor.getValue();
            
            if (!pythonCode.trim()) {
                showAlert('Por favor, insira algum c√≥digo Python.', 'warning');
                return;
            }

            // Mostrar loading
            const button = document.querySelector('.btn-transpile');
            const transpileText = button.querySelector('.transpile-text');
            const loadingSpinner = button.querySelector('.loading-spinner');
            
            transpileText.style.display = 'none';
            loadingSpinner.style.display = 'inline';
            button.disabled = true;

            try {
                const response = await fetch('/transpile', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        python_code: pythonCode
                    })
                });

                const data = await response.json();

                if (data.success) {
                    jsEditor.setValue(data.js_code);
                    showAlert('C√≥digo transpilado com sucesso!', 'success');
                } else {
                    showAlert(`Erro na transpila√ß√£o: ${data.error}`, 'danger');
                }

            } catch (error) {
                showAlert(`Erro de comunica√ß√£o: ${error.message}`, 'danger');
            } finally {
                // Esconder loading
                transpileText.style.display = 'inline';
                loadingSpinner.style.display = 'none';
                button.disabled = false;
            }
        }

        async function loadExamples() {
            try {
                const response = await fetch('/examples');
                const examples = await response.json();
                
                const container = document.getElementById('examples-container');
                
                examples.forEach(example => {
                    const col = document.createElement('div');
                    col.className = 'col-md-6 col-lg-3 mb-3';
                    
                    col.innerHTML = `
                        <div class="card example-card h-100" onclick="loadExample('${example.name}')">
                            <div class="card-body">
                                <h6 class="card-title">${example.name}</h6>
                                <p class="card-text text-muted small">Clique para carregar este exemplo</p>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(col);
                });

                // Armazenar exemplos globalmente
                window.examples = examples;

            } catch (error) {
                console.error('Erro ao carregar exemplos:', error);
            }
        }

        function loadExample(exampleName) {
            const example = window.examples.find(ex => ex.name === exampleName);
            if (example) {
                pythonEditor.setValue(example.python);
                jsEditor.setValue(example.javascript);
                showAlert(`Exemplo "${exampleName}" carregado!`, 'info');
            }
        }

        function clearPython() {
            pythonEditor.setValue('');
            jsEditor.setValue('');
        }

        function copyToClipboard() {
            const jsCode = jsEditor.getValue();
            if (!jsCode.trim()) {
                showAlert('N√£o h√° c√≥digo JavaScript para copiar.', 'warning');
                return;
            }

            navigator.clipboard.writeText(jsCode).then(() => {
                showAlert('C√≥digo JavaScript copiado para a √°rea de transfer√™ncia!', 'success');
            }).catch(err => {
                showAlert('Erro ao copiar c√≥digo.', 'danger');
            });
        }

        function showAlert(message, type) {
            const container = document.querySelector('.alert-container');
            const alert = document.createElement('div');
            alert.className = `alert alert-${type} alert-dismissible fade show`;
            alert.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            container.appendChild(alert);

            // Auto remove alert after 5 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 5000);
        }

        // Atalho de teclado para transpilar (Ctrl+Enter)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                transpileCode();
            }
        });
    </script>
</body>
</html>